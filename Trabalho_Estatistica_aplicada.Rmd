---
title: "Renda per capita dos municípios brasileiros"
output: html_notebook
---
Introdução

Este trabalho busca analisar o indicador economico Renda per capita do Brasil RDPC e correlacionalos com 5 variaveis explicativas.... 

Este trabalho consiste em analisar a correlação entre diversos indicadores socioeconomicos e a Renda Per Capita do Brasileiro e encontrar pelo menos 5 indicadores explicativos 

Todos os indicadores utilizados referem-se ao censo de 2000~2010. 

--

```{r}
#importanto Planilha para base_atlas_full
library(readxl)
base_atlas_full <- read_excel("C:\\Users\\alvaro\\Desktop\\R_Base\\atlas2013_dadosbrutos_pt_somente municipio.xlsx")

#separação da base por ano
basey_1991<- subset.data.frame(base_atlas_full, ANO==1991)

basey_2000<- subset.data.frame(base_atlas_full, ANO==2000)

basey_2010<- subset.data.frame(base_atlas_full, ANO==2010)

#inclusão do RPDC2010 na base de 2000
Y_RDPC_2010 <- c(basey_2010$RDPC)

basey_2000 <- data.frame(basey_2000,Y_RDPC_2010)

basey_rs<- subset.data.frame(basey_2000, UF==43)

#View(basey_2000)

```

Usar dados de 2000 para as variaveis e 2010 como Y.

Testando correlação de variaveis para encontrar as melhores variaveis que possam explicar Y=RDPC. 

Teste de correlação entre RDPC com Escolaridade I_ESCOLARIDADE. 


Histograma que representa a frequencia por renda per captita em toda a amostra.
```{r}
hist(basey_2000$Y_RDPC_2010)
```
A frequencia de casos com baixa renda é muito alta comparada com a alta renda per capita de alguns na amostra.

```{r}
#correlation formula = 0.8145292 81%

cor.test(basey_2000$Y_RDPC_2010,basey_2000$E_ANOSESTUDO) 
cor.test(basey_2000$Y_RDPC_2010,basey_2000$I_ESCOLARIDADE)

cor.test(basey_2000$Y_RDPC_2010,basey_2000$T_ENV)
cor.test(basey_2000$MULHERTOT,basey_2000$HOMEMTOT)

plot(basey_2000$Y_RDPC_2010~basey_2000$I_ESCOLARIDADE)


#step(lm(basey_2000$Y_RDPC_2010~.,data=basey_2000),direction="both")


modelSte <- step(lm(basey_2000$Y_RDPC_2010~basey_2000$ESPVIDA + basey_2000$FECTOT + basey_2000$MORT1 + 
basey_2000$MORT5 + basey_2000$RAZDEP + basey_2000$SOBRE40 + 
basey_2000$SOBRE60 + basey_2000$T_ENV + basey_2000$E_ANOSESTUDO	+ 
basey_2000$T_ANALF11A14 + basey_2000$T_ANALF15A17 + basey_2000$T_ANALF15M + 
basey_2000$T_ANALF18A24	+ basey_2000$T_ANALF18M	+ basey_2000$T_ANALF25A29 + basey_2000$T_ANALF25M + basey_2000$T_ATRASO_0_BASICO + 
basey_2000$T_ATRASO_0_FUND + basey_2000$T_ATRASO_0_MED + basey_2000$T_ATRASO_1_BASICO + basey_2000$T_ATRASO_1_FUND	+ 
basey_2000$T_ATRASO_1_MED + basey_2000$T_ATRASO_2_BASICO + basey_2000$T_ATRASO_2_FUND + basey_2000$T_ATRASO_2_MED + 
basey_2000$T_FBBAS + basey_2000$T_FBFUND + basey_2000$T_FBMED + basey_2000$T_FBPRE + basey_2000$T_FBSUPER + basey_2000$T_FLBAS + 
basey_2000$T_FLFUND + basey_2000$T_FLMED + basey_2000$T_FLPRE + basey_2000$T_FLSUPER,data=basey_2000),direction="both")

summary(modelSte)

```


```{r}
#Analizing data RS
dataset_RS <- lm(basey_rs$Y_RDPC_2010 ~ basey_rs$P_COM + 
                      basey_rs$CPR + 
                      basey_rs$TRABSC + 
                      basey_rs$TRABCC + 
                      basey_rs$HOMEMTOT + 
                      basey_rs$MULHERTOT +
                      basey_rs$T_CRIFUNDIN_TODOS +
                      basey_rs$T_DENS +
                      basey_rs$T_LIXO +
                      basey_rs$T_LUZ +
                      basey_rs$AGUA_ESGOTO + 
                      basey_rs$T_NESTUDA_NTRAB_MMEIO +
                      basey_rs$T_ENV +
                      basey_rs$E_ANOSESTUDO +
                      basey_rs$IDHM +
                      basey_rs$MORT1 +
                      basey_rs$T_SUPER25M +
                      basey_rs$T_MED18M
, data=basey_rs);

summary(dataset_RS);

#Analizing data RS removendo variaveis ~ Regressao linear
dataset_RS <- lm(formula = basey_rs$Y_RDPC_2010 ~ basey_rs$T_DENS +
                      basey_rs$AGUA_ESGOTO + 
                      basey_rs$E_ANOSESTUDO +
                      basey_rs$IDHM +
                      basey_rs$MORT1 +
                      basey_rs$pesoRUR +
                      basey_rs$pesotot +
                      basey_rs$pesourb +
                      basey_rs$PIND +
                      basey_rs$peso1517 +
                      basey_rs$PESO1524 +
                      basey_rs$PESO1618 +
                      basey_rs$T_FREQ0A3 +
                      basey_rs$T_FREQ11A14 +
                      basey_rs$T_FREQ15A17 +
                      basey_rs$T_FREQ18A24, data=basey_rs);



summary(dataset_RS);
plot(dataset_RS);

step(dataset_RS, direction = "both");


dataset_sug <- lm(formula = basey_rs$Y_RDPC_2010 ~ basey_rs$T_DENS + 
    basey_rs$IDHM + basey_rs$MORT1 + basey_rs$PIND  + 
    basey_rs$PESO1524, data = basey_rs)

summary(dataset_sug);


#plot(basey_rs$Município=="Porto Alegre"~basey_rs$Y_RDPC_2010

#inspecionando as variaveis preditordas
par(mfrow=c(1,2))

plot(basey_rs$Y_RDPC_2010~basey_rs$T_DENS, data=basey_rs)
plot(basey_rs$Y_RDPC_2010~basey_rs$AGUA_ESGOTO, data=basey_rs)
plot(basey_rs$Y_RDPC_2010~basey_rs$PIND, data=basey_rs)
plot(basey_rs$Y_RDPC_2010~basey_rs$IDHM, data=basey_rs)
plot(basey_rs$Y_RDPC_2010~basey_rs$MORT1, data=basey_rs)
plot(basey_rs$Y_RDPC_2010~basey_rs$I_ESCOLARIDADE, data=basey_rs)


par(mfrow=c(1,1))


#teste de correlação
cor.test(basey_rs$PIND,basey_rs$AGUA_ESGOTO) 

plot(all_variables)

step(all_variables, direction = "both")


anova(all_variables)

#step(best_set, direction = "both")

library(VGAM)
#regresão multipla
#reg_rs1 <- glm(basey_rs$RDPC~basey_rs$T_ENV + basey_rs$T_NESTUDA_NTRAB_MMEIO + basey_rs$T_LIXO + basey_rs$MULHERTOT + basey_rs$P_COM, family=binomial(link="logit"));
#reg_rs1 <- vglm(basey_rs$Y_RDPC_2010~basey_rs$T_ENV + basey_rs$T_NESTUDA_NTRAB_MMEIO, family=multinomial(refLevel=1),data=basey_rs);

#summary(reg_rs1)


```

```{r}
#TESTE DE VARIAVEIS vivi
#vou jogar o LM pra dentro de uma variavel
vivi_test <- lm(formula = basey_rs$Y_RDPC_2010 ~ basey_rs$GINI + basey_rs$PIND + basey_rs$PMPOB + basey_rs$PPOB + basey_rs$I_FREQ_PROP)

summary(vivi_test)
#dai vc pega o LM e faz um STEP

step(vivi_test, direction = "both")



```



2. Escolher 5 variáveis que possam ser consideradas explicativas para a renda per capita dos municípios. Pode-se optar por utilizar os municípios de uma UF apenas, ou de uma Região ou do Brasil todo.

3. Fazer uma análise descritiva destas variáveis e da renda per capita.

4. Aplicar a análise de regressão linear múltipla onde a VR é a renda per capita e as variáveis explicativas são as 5 escolhidas no passo 2.

5. Entregar na forma de relatório que contenha introdução, procedimentos para a coleta, cálculos e análise estatística, resultados das análises com interpretações e conclusões finais.

